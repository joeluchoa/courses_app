<%= form_with(model: course) do |form| %>
  <% if course.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(course.errors.count, "error") %> prohibited this course from being saved:</h2>

      <ul>
        <% course.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="mb-3">
    <%= form.label :name, class: "form-label" %>
    <%= form.text_field :name, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :description, class: "form-label" %>
    <%= form.textarea :description, class: "form-control"  %>
  </div>

  <div class="mb-3">
    <%= form.label :start_date, class: "form-label" %>
    <%= form.date_field :start_date, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :end_date, class: "form-label" %>
    <%= form.date_field :end_date, class: "form-control"  %>
  </div>

  <div class="mb-3">
    <%= form.label :address, class: "form-label" %>
    <%= form.text_area :address, class: "form-control", rows: 3 %>
  </div>

  <div class="mb-3">
    <%= form.label :teacher_id, t('activerecord.attributes.course.teacher'), class: "form-label" %>
    <%= form.collection_select :teacher_id, @teachers, :id, :name, { prompt: t('courses.form.select_a_teacher') }, { class: "form-select" } %>
  </div>

  <div class="mb-3">
    <h5><%= t('activerecord.attributes.course.weekly_schedule') %></h5>
    <p class="text-muted"><%= t('courses.form.select_the_days') %></p>

    <%# The responsive wrapper ensures the table doesn't break the layout on small screens %>
    <div class="card table-responsive">
      <%# table-striped adds zebra-striping, and align-middle vertically centers content in cells %>
      <table class="table table-striped align-middle">
        <thead class="table-light">
          <tr>
            <th scope="col" class="text-center"></th>
            <th scope="col"><%= t('courses.form.day') %></th>
            <th scope="col"><%= t('activerecord.attributes.course.start_time') %></th>
            <th scope="col"><%= t('activerecord.attributes.course.end_time') %></th>
          </tr>
        </thead>
        <tbody>
          <% @course.weekly_schedule_for_form.each_with_index do |schedule_item, index| %>
            <%= form.fields_for :weekly_schedule_attributes, schedule_item, index: index do |schedule_form| %>
              <tr data-controller="schedule-row">
                <%# Center the checkbox within its cell %>
                <td class="text-center">
                  <%= schedule_form.check_box :enabled, {
                    class: "form-check-input",
                    data: {
                      action: "change->schedule-row#toggle",
                      "schedule-row-target": "checkbox"
                    }
                  } %>
                </td>
                <td>
                  <%= schedule_form.label :day, t("weekdays.#{schedule_form.object.day.downcase}"), class: "mb-0" %>
                  <%= schedule_form.hidden_field :day %>
                </td>
                <td>
                  <%= schedule_form.time_field :start_time, {
                    class: "form-control",
                    data: { "schedule-row-target": "startTime" }
                  } %>
                </td>
                <td>
                  <%= schedule_form.time_field :end_time, {
                    class: "form-control",
                    data: { "schedule-row-target": "endTime" }
                  } %>
                </td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="actions">
    <%= form.submit t('actions.save'), class: "btn btn-success" %>
  </div>
<% end %>
